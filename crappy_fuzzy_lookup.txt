Function crappy_fuzzy_lookup(sourcecell As Range, searchrange As Range, outputoffset As Integer) As Variant
    'Like vlookup, but finds the closest match based on a count of matching substrings.
    'Note that the searchrange must be 1 dimensional, but outputoffset works the same as in the original 
    'VLOOKUP.

    cleanedsourcecell = Trim(sourcecell.Value) 'Unsure if this step is necessary...
    sourcestrings = Split(cleanedsourcecell)
    
    Dim maxmatchcount As Integer: maxmatchcount = 0
    Dim matchcount As Integer: matchcount = 0
    Dim maxmatchcell As Range
    For Each c In searchrange.Cells
        matchcount = 0
        For Each s In sourcestrings
            If InStr(c.Value, s) Then matchcount = matchcount + 1
        Next s
        If matchcount > maxmatchcount Then
            maxmatchcount = matchcount
            Set maxmatchcell = c
        End If
    Next c
    crappy_fuzzy_lookup = maxmatchcell.Offset(0, outputoffset).Value
End Function
